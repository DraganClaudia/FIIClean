<!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FII-Clean - Sistem Management SpÄƒlÄƒtorii</title>
    <link rel="stylesheet" href="css/main.css">
</head>
<body>
    <script src="js/header.js"></script>
    
    <main>
        <div id="guest-content">
            <section class="welcome-section">
                <h2>Bun venit la FII-Clean! ğŸ§½</h2>
                <p>Sistem complet de management pentru spÄƒlÄƒtorii profesionale</p>
                <div class="quick-access">
                    <a href="login.html" class="quick-btn">ğŸ”‘ Conectare</a>
                    <a href="dashboard.html" class="quick-btn">ğŸ“Š Dashboard Public</a>
                    <a href="locations.html" class="quick-btn">ğŸ“ LocaÈ›ii</a>
                </div>
            </section>
            
            <section>
                <h2>ğŸ¢ Serviciile Noastre</h2>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 2rem; margin: 2rem 0;">
                    <div class="card" style="text-align: center;">
                        <div style="font-size: 3rem; margin-bottom: 1rem;">ğŸ§½</div>
                        <h3>SpÄƒlare Covoare</h3>
                        <p>Servicii profesionale de curÄƒÈ›are pentru covoare È™i mochetÄƒ</p>
                    </div>
                    <div class="card" style="text-align: center;">
                        <div style="font-size: 3rem; margin-bottom: 1rem;">ğŸš—</div>
                        <h3>SpÄƒlare Auto</h3>
                        <p>CurÄƒÈ›are completÄƒ interior È™i exterior pentru vehicule</p>
                    </div>
                    <div class="card" style="text-align: center;">
                        <div style="font-size: 3rem; margin-bottom: 1rem;">ğŸ‘”</div>
                        <h3>CurÄƒÈ›are Haine</h3>
                        <p>Servicii de curÄƒÈ›are chimicÄƒ pentru Ã®mbrÄƒcÄƒminte</p>
                    </div>
                </div>
            </section>
        </div>
        
        <div id="user-content" style="display: none;">
            <section class="welcome-section">
                <h2>Bun venit Ã®napoi! ğŸ‘‹</h2>
                <p id="user-welcome-message">Loading...</p>
                <div class="quick-access" id="user-quick-actions">
                </div>
            </section>
            
            <div id="role-specific-content">
            </div>
        </div>
        
        <section id="locations-section">
            <h2>ğŸ“ LocaÈ›iile Noastre</h2>
            <div id="locations-list">
                <p>Se Ã®ncarcÄƒ locaÈ›iile...</p>
            </div>
            <div style="text-align: center; margin-top: 2rem;">
                <a href="locations.html" class="btn btn-primary">Vezi Toate LocaÈ›iile</a>
            </div>
        </section>
    </main>
    
    <script src="js/api.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            initializePage();
        });

        async function initializePage() {
            const isAuthenticated = checkAuthStatus();
            
            if (isAuthenticated) {
                await loadUserContent();
                document.getElementById('guest-content').style.display = 'none';
                document.getElementById('user-content').style.display = 'block';
            } else {
                document.getElementById('guest-content').style.display = 'block';
                document.getElementById('user-content').style.display = 'none';
            }
            
            await loadLocationsPreview();
        }

        async function loadUserContent() {
            try {
                const userData = await AuthAPI.getMe();
                if (userData.success) {
                    const user = userData.user;
                    
                    document.getElementById('user-welcome-message').textContent = 
                        `Salut, ${user.first_name}! GestioneazÄƒ-È›i activitatea cu uÈ™urinÈ›Äƒ.`;
                    
                    setupRoleContent(user.role);
                }
            } catch (error) {
                console.error('Eroare la Ã®ncÄƒrcarea datelor utilizatorului:', error);
                document.getElementById('guest-content').style.display = 'block';
                document.getElementById('user-content').style.display = 'none';
            }
        }

        function setupRoleContent(role) {
            const actionsContainer = document.getElementById('user-quick-actions');
            const contentContainer = document.getElementById('role-specific-content');
            
            const roleConfigs = {
                'admin': {
                    actions: [
                        { href: 'admin.html', icon: 'ğŸ‘‘', text: 'Admin Panel' },
                        { href: 'orders.html', icon: 'ğŸ“‹', text: 'Toate Comenzile' },
                        { href: 'locations.html', icon: 'ğŸ“', text: 'Gestionare LocaÈ›ii' }
                    ],
                    content: `
                        <div class="card">
                            <h3>ğŸ¯ Acces Rapid Admin</h3>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-top: 1rem;">
                                <a href="admin.html" class="btn" style="padding: 2rem; text-align: center; text-decoration: none;">
                                    <div style="font-size: 2rem; margin-bottom: 0.5rem;">ğŸ‘¥</div>
                                    Gestionare Utilizatori
                                </a>
                                <a href="orders.html" class="btn" style="padding: 2rem; text-align: center; text-decoration: none;">
                                    <div style="font-size: 2rem; margin-bottom: 0.5rem;">ğŸ“‹</div>
                                    Toate Comenzile
                                </a>
                                <a href="locations.html" class="btn" style="padding: 2rem; text-align: center; text-decoration: none;">
                                    <div style="font-size: 2rem; margin-bottom: 0.5rem;">ğŸ“</div>
                                    Gestionare LocaÈ›ii
                                </a>
                            </div>
                        </div>
                    `
                },
                'manager': {
                    actions: [
                        { href: 'manager.html', icon: 'ğŸ‘¨â€ğŸ’¼', text: 'Manager Dashboard' },
                        { href: 'orders.html', icon: 'ğŸ“‹', text: 'Comenzi LocaÈ›ia' },
                        { href: 'resources.html', icon: 'ğŸ“¦', text: 'Resurse' }
                    ],
                    content: `
                        <div class="card">
                            <h3>ğŸ¯ Acces Rapid Manager</h3>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-top: 1rem;">
                                <a href="manager.html" class="btn" style="padding: 2rem; text-align: center; text-decoration: none;">
                                    <div style="font-size: 2rem; margin-bottom: 0.5rem;">ğŸ‘·</div>
                                    Worker-ii Mei
                                </a>
                                <a href="orders.html" class="btn" style="padding: 2rem; text-align: center; text-decoration: none;">
                                    <div style="font-size: 2rem; margin-bottom: 0.5rem;">ğŸ“‹</div>
                                    Comenzi LocaÈ›ie
                                </a>
                                <a href="resources.html" class="btn" style="padding: 2rem; text-align: center; text-decoration: none;">
                                    <div style="font-size: 2rem; margin-bottom: 0.5rem;">ğŸ“¦</div>
                                    Resurse
                                </a>
                            </div>
                        </div>
                    `
                },
                'client': {
                    actions: [
                        { href: 'client.html', icon: 'ğŸ‘¤', text: 'Contul Meu' },
                        { onclick: 'quickOrder()', icon: 'â•', text: 'ComandÄƒ RapidÄƒ' },
                        { href: 'orders.html', icon: 'ğŸ“‹', text: 'Comenzile Mele' }
                    ],
                    content: `
                        <div class="card">
                            <h3>ğŸ¯ Acces Rapid la Servicii</h3>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 1rem; margin-top: 1rem;">
                                <button onclick="quickOrder('covoare')" class="btn" style="padding: 2rem; display: flex; flex-direction: column; align-items: center; gap: 0.5rem;">
                                    <span style="font-size: 2rem;">ğŸ§½</span>
                                    <span>ComandÄƒ SpÄƒlare Covoare</span>
                                </button>
                                <button onclick="quickOrder('auto')" class="btn" style="padding: 2rem; display: flex; flex-direction: column; align-items: center; gap: 0.5rem;">
                                    <span style="font-size: 2rem;">ğŸš—</span>
                                    <span>ComandÄƒ SpÄƒlare Auto</span>
                                </button>
                                <button onclick="quickOrder('haine')" class="btn" style="padding: 2rem; display: flex; flex-direction: column; align-items: center; gap: 0.5rem;">
                                    <span style="font-size: 2rem;">ğŸ‘”</span>
                                    <span>ComandÄƒ CurÄƒÈ›are Haine</span>
                                </button>
                            </div>
                        </div>
                    `
                },
                'worker_transport': {
                    actions: [
                        { href: 'transport.html', icon: 'ğŸš›', text: 'Transport Dashboard' },
                        { href: 'orders.html', icon: 'ğŸ“‹', text: 'Sarcinile Mele' }
                    ],
                    content: `
                        <div class="card">
                            <h3>ğŸš› Sarcini Transport</h3>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-top: 1rem;">
                                <a href="transport.html" class="btn" style="padding: 2rem; text-align: center; text-decoration: none;">
                                    <div style="font-size: 2rem; margin-bottom: 0.5rem;">ğŸš›</div>
                                    Sarcinile Mele
                                </a>
                                <a href="orders.html" class="btn" style="padding: 2rem; text-align: center; text-decoration: none;">
                                    <div style="font-size: 2rem; margin-bottom: 0.5rem;">ğŸ“‹</div>
                                    Toate Comenzile
                                </a>
                            </div>
                        </div>
                    `
                },
                'worker_cleaner': {
                    actions: [
                        { href: 'cleaner.html', icon: 'ğŸ§½', text: 'Cleaner Dashboard' },
                        { href: 'orders.html', icon: 'ğŸ“‹', text: 'Sarcinile Mele' }
                    ],
                    content: `
                        <div class="card">
                            <h3>ğŸ§½ Sarcini CurÄƒÈ›are</h3>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-top: 1rem;">
                                <a href="cleaner.html" class="btn" style="padding: 2rem; text-align: center; text-decoration: none;">
                                    <div style="font-size: 2rem; margin-bottom: 0.5rem;">ğŸ§½</div>
                                    Sarcinile Mele
                                </a>
                                <a href="orders.html" class="btn" style="padding: 2rem; text-align: center; text-decoration: none;">
                                    <div style="font-size: 2rem; margin-bottom: 0.5rem;">ğŸ“‹</div>
                                    Toate Comenzile
                                </a>
                            </div>
                        </div>
                    `
                }
            };

            const config = roleConfigs[role];
            if (config) {
                actionsContainer.innerHTML = config.actions.map(action => 
                    action.onclick ? 
                        `<button onclick="${action.onclick}" class="quick-btn">${action.icon} ${action.text}</button>` :
                        `<a href="${action.href}" class="quick-btn">${action.icon} ${action.text}</a>`
                ).join('');

                contentContainer.innerHTML = config.content;
            }
        }

        async function loadLocationsPreview() {
            try {
                const locations = await LocationsAPI.getAll();
                displayLocationsPreview(locations.slice(0, 3));
            } catch (error) {
                document.getElementById('locations-list').innerHTML = '<p>Eroare la Ã®ncÄƒrcarea locaÈ›iilor.</p>';
            }
        }

        function displayLocationsPreview(locations) {
            const container = document.getElementById('locations-list');
            
            if (locations.length === 0) {
                container.innerHTML = '<p>Nu existÄƒ locaÈ›ii Ã®nregistrate.</p>';
                return;
            }
            
            const html = locations.map(location => `
                <div class="card" style="margin-bottom: 1rem;">
                    <h3>ğŸ“ ${location.name}</h3>
                    <p><strong>AdresÄƒ:</strong> ${location.address}</p>
                    <p><strong>Servicii:</strong> ${location.services || 'Nu sunt specificate'}</p>
                    <p><strong>Status:</strong> ${location.status === 'active' ? 
                        '<span class="status-active">ğŸŸ¢ Activ</span>' : 
                        '<span class="status-inactive">ğŸ”´ Inactiv</span>'}</p>
                </div>
            `).join('');
            
            container.innerHTML = html;
        }

        function quickOrder(serviceType = null) {
            if (serviceType) {
                localStorage.setItem('quick_order_service', serviceType);
            }
            window.location.href = 'client.html';
        }
    </script>
</body>
</html>
